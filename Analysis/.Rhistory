matrix(c(1,1,1,2,3,4), ncol=2)
library(gbm)
gbm.perf
?gbm.perf
?gbm
load('/media/drakelab/Lexar/8910Project/Analysis/RdataFiles/pest(reduced)2_1.RData')
ls()
brtResults.all
testRet=apply(as.matrix(ret), 2, as.numeric)
testRetb=apply(as.matrix(ret.b),2, as.numeric)
testRetc=apply(as.matrix(ret.c),2, as.numeric)
testRetgeo=apply(as.matrix(ret.geo),2,as.numeric)
meanAUC = colMeans(testRet)
meanSE = apply(testRet, 2, sd) / sqrt(nrow(testRet))
meanSD = apply(testRet, 2, sd)
meanAUC.b = colMeans(testRetb)
meanSE.b = apply(testRetb, 2, sd) / sqrt(nrow(testRetb))
meanSD.b = apply(testRetb, 2, sd)
meanAUC.c = colMeans(testRetc)
meanSE.c = apply(testRetc, 2, sd) / sqrt(nrow(testRetc))
meanSD.c = apply(testRetc, 2, sd)
meanAUC.geo = colMeans(testRetgeo)
meanSE.geo = apply(testRetgeo, 2, sd) / sqrt(nrow(testRetgeo))
meanSD.geo = apply(testRetgeo, 2, sd)
brt.zero=c(meanAUC[1], meanAUC.geo[1], meanAUC.b[1], meanAUC.c[1])
brt.zero.se=c(meanSE[1], meanSE.geo[1],  meanSE.b[1], meanSE.c[1])
brt.zero.sd=c(meanSD[1], meanSD.geo[1],  meanSD.b[1], meanSD.c[1])
brt.meanAUC=c(meanAUC[3], meanAUC.geo[3],  meanAUC.b[3], meanAUC.c[3])
brt.se=c(meanSE[3], meanSE.geo[3],  meanSE.b[3], meanSE.c[3])
brt.sd=c(meanSD[3], meanSD.geo[3],  meanSD.b[3], meanSD.c[3])
plot(1:5, c(mean(brt.zero),brt.meanAUC), ylim=c(0.45, 1), xlim=c(0.7,5.3), las=1, pch=16, tck=0.01, xaxt='n', xlab='', ylab='Area under ROC curve')
brt.meanAUC
mean(brt.zero)
dim(pest)
colnames(pest)
pest[,18]
range(pest[,18])
range(pest[,18], na.rm=TRUE)
range(as.numeric(as.character(pest[,18])), na.rm=TRUE)
library(rfishbase); library(gbm); library(ROCR); library(e1071); library(randomForest)
load('/media/drakelab/Lexar/8910Project/Analysis/RdataFiles/pest(reduced).RData')
load('/media/drakelab/Lexar/8910Project/Analysis/RdataFiles/pest(reduced)2_1.RData')
brt.meanAUC
testRet=apply(as.matrix(ret), 2, as.numeric)
testRetb=apply(as.matrix(ret.b),2, as.numeric)
testRetc=apply(as.matrix(ret.c),2, as.numeric)
testRetgeo=apply(as.matrix(ret.geo),2,as.numeric)
meanAUC = colMeans(testRet)
meanSE = apply(testRet, 2, sd) / sqrt(nrow(testRet))
meanSD = apply(testRet, 2, sd)
meanAUC.b = colMeans(testRetb)
meanSE.b = apply(testRetb, 2, sd) / sqrt(nrow(testRetb))
meanSD.b = apply(testRetb, 2, sd)
meanAUC.c = colMeans(testRetc)
meanSE.c = apply(testRetc, 2, sd) / sqrt(nrow(testRetc))
meanSD.c = apply(testRetc, 2, sd)
meanAUC.geo = colMeans(testRetgeo)
meanSE.geo = apply(testRetgeo, 2, sd) / sqrt(nrow(testRetgeo))
meanSD.geo = apply(testRetgeo, 2, sd)
brt.zero=c(meanAUC[1], meanAUC.geo[1], meanAUC.b[1], meanAUC.c[1])
brt.zero.se=c(meanSE[1], meanSE.geo[1],  meanSE.b[1], meanSE.c[1])
brt.zero.sd=c(meanSD[1], meanSD.geo[1],  meanSD.b[1], meanSD.c[1])
brt.meanAUC=c(meanAUC[3], meanAUC.geo[3],  meanAUC.b[3], meanAUC.c[3])
brt.se=c(meanSE[3], meanSE.geo[3],  meanSE.b[3], meanSE.c[3])
brt.sd=c(meanSD[3], meanSD.geo[3],  meanSD.b[3], meanSD.c[3])
brt.meanAUC
mean(brt.zero)
brtMean.c = rowMeans(brtResults.all)
brtMean.c
sum(brtMean.c[c(10)])
sum(brtMean.c[c(10,12:16)])
sum(brtMean.c)
brtResults.geo
brtResults.traits
cols=c('#7EC0EE', '#CC9999', '#99CC99')
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[inds,], col=cols[c(1,1,1,2,2,2,3,1,1,2,1,2,3,3,3,2,3)], xaxt='n', axes=FALSE, border = NA)
barplot(brtResults.all, col=cols[c(1,1,1,2,2,2,3,1,1,2,1,2,3,3,3,2,3)], xaxt='n', axes=FALSE, border = NA)
rownames(brtResults.all)
cols=c('#7EC0EE', '#CC9999', '#99CC99')
inds=c(1,2,3,4,9,5,6,7,8,13,10,14,15,16,17,18,11,12)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[inds,], col=cols[c(1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
brtResults.all[inds,]
rownames(brtResults.all)
dim(brtResults.all)
brtResults.all[inds,]
dim(brtResults.all)
rownames(brtResults.all)
cols=c('#7EC0EE', '#CC9999', '#99CC99')
inds=c(1,1,1,1,2,2,1,1,2,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=cols[c(1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
inds
length(inds)
cols=c('#7EC0EE', '#CC9999', '#99CC99')
inds=c(1,1,1,1,2,1,1,2,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=cols[c(1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
brtResults[order(inds),]
inds
length(inds)
order(inds)
brtResults.all[order(inds),]
cols=c('#7EC0EE', '#CC9999', '#99CC99')
inds=c(1,1,1,1,2,1,1,2,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=cols[c(1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
cols=c('#7EC0EE', '#CC9999', '#99CC99')
inds=c(1,1,1,1,2,1,1,2,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=cols[rev(c(1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3))], xaxt='n', axes=FALSE, border = NA)
rownames(brtResults.all)
cols=c('#7EC0EE', '#CC9999', '#99CC99')
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=cols[inds], xaxt='n', axes=FALSE, border = NA)
brtResults.all[order(inds),]
rownames(brtResults.all)
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=cols[inds], xaxt='n', axes=FALSE, border = NA)
brtResults.all[order(inds),]
c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)
length(c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3))
cols=c('#7EC0EE', '#CC9999', '#99CC99')
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=cols[c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
cols=c('#7EC0EE',  '#99CC99', '#CC9999')
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=cols[c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
cols=c('#7EC0EE',  '#32CD32', '#CC9999')
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=cols[c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
cols=c('#CD3232',  '#32CD32', '#CC9999')
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=cols[c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
cols=c('#7EC0EE',  '#32CD32', '#CD3232')
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=cols[c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
cols=c('#7EC0EE',  '#32CD32', '#CD3232')
greycols=c(grey(0.25,0.5), grey(0.75,0.5), 'black')
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=greycols[c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
greycols=c(grey(0.75,0.5), grey(0.25,0.5), 'black')
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=greycols[c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
brtResults.all[order(inds),]
rowMeans(brtResults.all[order(inds),])
sum(rowMeans(brtResults.all[order(inds),])[1:6])
sum(rowMeans(brtResults.all[order(inds),])[8:12])
sum(rowMeans(brtResults.all[order(inds),])[13:18])
cols=c('#7EC0EE',  '#32CD32', '#CD3232')
greycols=c(grey(0.75,0.5), grey(0.25,0.5), 'black')
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=greycols[c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
plot.new()
legend(0.02,0.85, c('Host traits', 'Geographic variables', 'Parasite community variables'), col=greycols, ncol=3, pt.cex=2, text.width=0.2, pch=16)
cols=c('#7EC0EE',  '#32CD32', '#CD3232')
greycols=c(grey(0.75,0.5), grey(0.25,0.5), 'black')
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=greycols[c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
plot.new()
legend(0.02,0.85, c('Host traits', 'Geographic variables', 'Parasite community variables'), col=greycols, ncol=3, pt.cex=2, text.width=0.1, pch=16)
?legend
cols=c('#7EC0EE',  '#32CD32', '#CD3232')
greycols=c(grey(0.75,0.5), grey(0.25,0.5), 'black')
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=greycols[c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
plot.new()
legend(0.02,0.85, c('Host traits', 'Geographic variables', 'Parasite community variables'), col=greycols, ncol=3, pt.cex=2, text.width=0.1, pch=16, bty='n')
cols=c('#7EC0EE',  '#32CD32', '#CD3232')
greycols=c(grey(0.75,0.5), grey(0.25,0.5), 'black')
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=greycols[c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
plot.new()
legend(0.02,0.85, c('Host traits', 'Geographic variables', 'Parasite community variables'), col=greycols, ncol=3, pt.cex=2, text.width=c(0.1,0.15), pch=16, bty='n')
cols=c('#7EC0EE',  '#32CD32', '#CD3232')
greycols=c(grey(0.75,0.5), grey(0.25,0.5), 'black')
inds=c(1,1,1,1,2,1,1,1,2,3,2,3,3,3,3,3,2,2)
layout(matrix(c(1,2),ncol=1), heights=c(2.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults.all[order(inds),], col=greycols[c(1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3)], xaxt='n', axes=FALSE, border = NA)
plot.new()
legend(0.02,0.85, c('Host traits', 'Geographic variables', 'Parasite community variables'), col=greycols, ncol=3, pt.cex=2, text.width=c(0, 0.1,0.15), pch=16, bty='n')
load('/media/drakelab/Lexar/8910Project/Analysis/RdataFiles/pest(reduced).RData')
load('/media/drakelab/Lexar/8910Project/Analysis/RdataFiles/pest(reduced)2_2.RData')
brtMean.c[inds]
brtMean.c = rowMeans(brtResults.all)
inds=order(brtMean.c)
brtMean.c[inds]
layout(matrix(c(1,2),ncol=1), heights=c(1.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults[,order(hostNum)], col=rainbow(15), xaxt='n', axes=FALSE, border = NA)
plot.new()
legend(0.02,0.85,varNames , pch=16, col=rainbow(15), ncol=4, pt.cex=2, text.width=0.2)
layout(matrix(c(1,2,3),ncol=3))
plot(1:5, meanAUC, ylim=c(0.45, 1), xlim=c(0.5,5.5), las=1, pch=16, tck=0.01, xaxt='n', xlab='Predictive model used', ylab='Area Under ROC curve', main='Host traits')
abline(h=0.5, col=grey(0.5), lty=2, lwd=2)
segments(x0=1:5, y0=meanAUC+meanSD, y1=meanAUC-meanSD, col=grey(0.8),lwd=2)
points(1:5, meanAUC, pch=16, cex=1.5)
axis(1, at=1:5, labels=c('Base', 'BRT', 'SVM', 'LR', 'RF'), tck=0.01, srt=30)
plot(1:5, meanAUC.b, ylim=c(0.45, 1), xlim=c(0.5,5.5), las=1, pch=16, tck=0.01, xaxt='n', xlab='Predictive model used', ylab='Area Under ROC curve', main='Parasite community dissimilarity')
abline(h=0.5, col=grey(0.5), lty=2, lwd=2)
segments(x0=1:5, y0=meanAUC.b+meanSD.b, y1=meanAUC.b-meanSD.b, col=grey(0.8),lwd=2)
points(1:5, meanAUC.b, pch=16, cex=1.5)
axis(1, at=1:5, labels=c('Base', 'BRT', 'SVM', 'LR', 'RF'), tck=0.01, srt=30)
plot(1:5, meanAUC.c, ylim=c(0.45, 1), xlim=c(0.5,5.5), las=1, pch=16, tck=0.01, xaxt='n', xlab='Predictive model used', ylab='Area Under ROC curve', main='Both host and parasite data')
abline(h=0.5, col=grey(0.5), lty=2, lwd=2)
segments(x0=1:5, y0=meanAUC.c+meanSD.c, y1=meanAUC.c-meanSD.c, col=grey(0.8),lwd=2)
points(1:5, meanAUC.c, pch=16, cex=1.5)
axis(1, at=1:5, labels=c('Base', 'BRT', 'SVM', 'LR', 'RF'), tck=0.01, srt=30)
n tree analysis? (no).
layout(matrix(c(1,2),ncol=1), heights=c(1.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults[,order(hostNum)], col=rainbow(15), xaxt='n', axes=FALSE, border = NA)
plot.new()
legend(0.02,0.85,varNames , pch=16, col=rainbow(15), ncol=4, pt.cex=2, text.width=0.2)
layout(matrix(c(1,2),ncol=1), heights=c(1.5, 1))
par(mar=c(0.25,0.25,0.25,0.25))
barplot(brtResults[,order(hostNum)], col=rainbow(15), xaxt='n', axes=FALSE, border = NA)
plot(hostNum[1:238], ret[1:238,'BRT'], tck=0.01, las=1, xlab='Number host species infected', pch=16, ylab='Accuracy (AUC)')
points(hostNum[1:238], ret.geo[1:238,'BRT'], pch=16, col='skyblue' )
points(hostNum[1:238], ret.b[1:238,'BRT'], pch=16, col='darkseagreen1')
points(hostNum[1:238], ret.c[1:238,'BRT'], pch=16, col='firebrick3')
abline(h=0.5, col=grey(0.5,0.5), lwd=2, lty=2)
legend(100, 0.4, c('Host traits', 'Geography', 'Parasite community', 'Full model'), pch=16, col=c(1, 'skyblue','darkseagreen1', 'firebrick3'), bty='n')
plot(hostNum[1:238], ret[1:238,'BRT'], tck=0.01, las=1, xlab='Number host species infected', pch=16, ylab='Accuracy (AUC)')
points(hostNum[1:238], ret.geo[1:238,'BRT'], pch=16, col='skyblue' )
smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT'])
lines(smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=2, col='skyblue')
plot.new()
lines(smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=2, col='skyblue')
plot(smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=2, col='skyblue')
spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=2, col='skyblue')
plot(spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=2, col='skyblue')
?spline
plot(hostNum[1:238], ret[1:238,'BRT'], tck=0.01, las=1, xlab='Number host species infected', pch=16, ylab='Accuracy (AUC)')
points(hostNum[1:238], ret.geo[1:238,'BRT'], pch=16, col='skyblue')
lines(smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=2.2, col=1)
lines(smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=2, col='skyblue')
plot(hostNum[1:238], ret[1:238,'BRT'], tck=0.01, las=1, xlab='Number host species infected', pch=16, ylab='Accuracy (AUC)')
points(hostNum[1:238], ret.geo[1:238,'BRT'], pch=16, col='skyblue')
lines(smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=2.5, col=1)
lines(smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=2, col='skyblue')
plot(hostNum[1:238], ret[1:238,'BRT'], tck=0.01, las=1, xlab='Number host species infected', pch=16, ylab='Accuracy (AUC)')
points(hostNum[1:238], ret.geo[1:238,'BRT'], pch=16, col='skyblue')
lines(smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=4, col=1)
lines(smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=3, col='skyblue')
points(hostNum[1:238], ret.b[1:238,'BRT'], pch=16, col='darkseagreen1')
lines(smooth.spline(hostNum[1:238], ret.b[1:238, 'BRT']), lwd=2, col=1)
lines(smooth.spline(hostNum[1:238], ret.b[1:238, 'BRT']), lwd=2, col='darkseagreen1')
plot(hostNum[1:238], ret[1:238,'BRT'], tck=0.01, las=1, xlab='Number host species infected', pch=16, ylab='Accuracy (AUC)')
points(hostNum[1:238], ret.geo[1:238,'BRT'], pch=16, col='skyblue')
lines(smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=4.25, col=1)
lines(smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=3, col='skyblue')
points(hostNum[1:238], ret.b[1:238,'BRT'], pch=16, col='darkseagreen1')
lines(smooth.spline(hostNum[1:238], ret.b[1:238, 'BRT']), lwd=4.25, col=1)
lines(smooth.spline(hostNum[1:238], ret.b[1:238, 'BRT']), lwd=3, col='darkseagreen1')
points(hostNum[1:238], ret.c[1:238,'BRT'], pch=16, col='firebrick3')
lines(smooth.spline(hostNum[1:238], ret.c[1:238, 'BRT']), lwd=4.25, col=1)
lines(smooth.spline(hostNum[1:238], ret.c[1:238, 'BRT']), lwd=3, col='firebrick3')
plot(hostNum[1:238], ret[1:238,'BRT'], tck=0.01, las=1, xlab='Number host species infected', pch=16, ylab='Accuracy (AUC)')
points(hostNum[1:238], ret.geo[1:238,'BRT'], pch=16, col='skyblue')
points(hostNum[1:238], ret.b[1:238,'BRT'], pch=16, col='darkseagreen1')
points(hostNum[1:238], ret.c[1:238,'BRT'], pch=16, col='firebrick3')
lines(smooth.spline(hostNum[1:238], ret[1:238, 'BRT']), lwd=4.25, col=1)
lines(smooth.spline(hostNum[1:238], ret[1:238, 'BRT']), lwd=3, col=1)
lines(smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=4.25, col=1)
lines(smooth.spline(hostNum[1:238], ret.geo[1:238, 'BRT']), lwd=3, col='skyblue')
lines(smooth.spline(hostNum[1:238], ret.b[1:238, 'BRT']), lwd=4.25, col=1)
lines(smooth.spline(hostNum[1:238], ret.b[1:238, 'BRT']), lwd=3, col='darkseagreen1')
lines(smooth.spline(hostNum[1:238], ret.c[1:238, 'BRT']), lwd=4.25, col=1)
lines(smooth.spline(hostNum[1:238], ret.c[1:238, 'BRT']), lwd=3, col='firebrick3')
abline(h=0.5, col=grey(0.5,0.5), lwd=2, lty=2)
legend(100, 0.4, c('Host traits', 'Geography', 'Parasite community', 'Full model'), pch=16, col=c(1, 'skyblue','darkseagreen1', 'firebrick3'), bty='n')
dev.copy(pdf, width=5, height=5, '../Manuscript/Figures/hostNumAccuracy.pdf'); dev.off()
